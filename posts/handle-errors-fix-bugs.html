<!DOCTYPE html>
<html lang="ar">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta
  name="description"
  content="موقع حسان القوز حيث يجمع فيه الدورات والمشاريع."
/>
<meta name="author" content="Hassan Algoz" />

<link rel="shortcut icon" type="image/x-icon" href="/assets/favicon.ico" />
<!-- CSS -->
<link
  rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
/>
<link
  href="//fonts.googleapis.com/earlyaccess/droidarabickufi.css"
  rel="stylesheet"
/>

<!-- Prioritized CSS -->
<style>
  body {
    margin: 0;
  }

  .wrapper {
    max-width: 960px;
    margin: 0 auto 30px;
    padding: 20px 24px;
  }

  .center {
    margin: 0 auto;
    text-align: center;
  }

  .hide {
    display: none;
  }
</style>

<!-- Custom -->
<link rel="stylesheet" href="/main.css" />

    <title>معالجة الخطأ المُبرمَج وإصلاح الغلط الإنشائي - 2020-11-28</title>
    <link rel="stylesheet" href="/posts/layout.css">
    <script src="/posts/layout.js" defer async></script>
</head>
<body>
    <nav dir="rtl">
  <label for="show-menu" class="show-menu">إظهار القائمة</label>
  <input type="checkbox" id="show-menu" role="button" />
  <ul id="menu">
    <li><a href="/pages/study/study.html">مصادر للطالب</a></li>
    <li>
      <a href="#">تعلم الآلة ￬</a>
      <ul class="hidden">
        <li><a href="/pages/hand-signs/hand-signs.html">رؤية الحاسب</a></li>
        <li><a href="/pages/ann-lm/ann-lm.html">نمذجة اللغة</a></li>
      </ul>
    </li>
    <li>
      <a href="#">تطبيقات ￬</a>
      <ul class="hidden">
        <li>
          <a href="/pages/subtitles/subtitles.html">برنامج التفريغ والترجمة</a>
        </li>
        <li><a href="/pages/editor/editor.html">مُحرر Markdown</a></li>
        <li><a href="/pages/dict/dict.html">قاموس المصطلحات</a></li>
      </ul>
    </li>
    <li><a href="/">الرئيسية</a></li>
  </ul>
</nav>

    <div class="post-container" dir="rtl">
        <h1>معالجة الخطأ المُبرمَج وإصلاح الغلط الإنشائي</h1>
        <div class="publish-date">نشر في 2020-11-28</div>
        <div class="reading-time"></div>
        <div class="post-body">
            <p>بسم الله الرحمن الرحيم.</p>
<h1 id="">مقدمة</h1>
<p>معالجة الأخطاء من المواضيع الأساسية لأي مبرمج يستعمل أي لغة. والتفريق بينها وبين الأغلاط الإنشائية لا بُدَّ منه لأنه حصل فيه خلطٌ سببته لغاتٌ مشتهرة. وبحثت هذا الموضوع رجاء الوصول لخلاصة تعين المبرمج على إنشاء برمجيات صحيحة، وخرجت لك بخلاصة بحثي في هذه المحاور:</p>
<ul>
<li>معيار صحَّة البرنامج</li>
<li>الفرق بين الخطأ المُبرمَج والغلط الإنشائي<ul>
<li>سبب الخلط بين الخطأ المُبرمَج والغلط الإنشائي</li></ul></li>
<li>معالجة الخطأ المُبرمَج<ul>
<li>ضرورة عدم إهمال الخطأ المُبرمَج</li>
<li>استرجاع حال ما قبل الإجراء</li>
<li>تسلسل الأخطاء</li>
<li>إيصال رسالة الخطأ</li></ul></li>
<li>إصلاح الغلط الإنشائي<ul>
<li>المرحلة الأولى: العلم بوجود الغلط</li>
<li>المرحلة الثانية: تتبع أصل الغلط</li>
<li>المرحلة الثالثة: إصلاح الغلط</li></ul></li>
</ul>
<h1 id="-1">معيار صحَّة البرنامج</h1>
<p>البرنامج إجراءات تعمل على بيانات؛ وصحة الإجراء أن تُصِّدق تفاصيلُه وصفَه.</p>
<p>والإجراء له وصفان: وصفٌ بلغة البرمجة، ووصفٌ بلغة الخطاب. فالأوَّل تفهمه الأدوات البرمجية فتساعدك في الكتابة والتعديل والقراءة، وهو الذي يتحوَّل إلى أوامِر تنفيذية، والثاني يفهمه المستخدم (المبرمج) ويُسمَّى التوثيق (documentation).</p>
<p>وبالتوثيق يُعرف مدى تأثر وتأثير الإجراء؛ فقد يتأثر بغير مُدخلاته، أو يؤثِّرُ هو بمدخلاته، أو يؤثّر في غير محلّ مخرجاته، ومثل ذلك يصعُب ضبطه فاجتنابه أسلم وأقرب للصحة.</p>
<p>والوصف بلغة البرمجة يحوي مُعرِّف الإجراء، وقيوداً أخرى.</p>
<p>فمُعرِّف الإجراء (function signature): هو ما يُميَّز به بين إجراءٍ وآخر، فمن ذلك: اسم الإجراء ومدخلاته ونوعها ومخرجاته ونوعها. فإذا اتفق اسمان، عرف البرنامج أي الإجرائين يُجري باختلاف الحدود الأخرى للمعرِّف. وهذا يُعرف باسم (function overloading). وقد تقيِّد اللغة المدخلات والمخرجات بما يزيد عن تحديد نوعها، وهو ما يُعرفُ بالتوكيد (assertion).</p>
<p>فإذا قرأ المستخدم الوصفين عرف ما يأخذ الإجراء وما يُخرج، فلا يعطيه ما لا يقبل ولا يتوقَّع منه ما لا يضمن.</p>
<h1 id="-2">الفرق بين الخطأ المُبرمَج والغلط الإنشائي</h1>
<p>ومن مُخرجات الإجراء: الخطأ (المُبرمَج). سواء خرج بالرجوع (return) أو بالرمي (throw).</p>
<p><strong>فالخطأ المُبرمَج</strong>: يحدث حين تُفحص البيانات فيقرر أنها في حالة غير صالحة للمعالجة. مثلاً:  انقطاع الشبكة، أو فقدان ملفّ توقَّع في مكانٍ ما، أو إدخال عددٍ مكان حرفٍ، أو إدخال قيمة أكبر من الحد الأعلى، ..إلخ.</p>
<p>أما <strong>الغلط في الإنشاء</strong>: فإنَّه خروج البرنامج عما بُرمِجَ له. وهو غلط من أنشأ شيئًا من البرنامج، ولذلك فإنه حين يقع لا حوْل للبرنامج في معالجته إلا بالتوقُّف والإبلاغ عنه.</p>
<h2 id="-3">سبب الخلط بين الخطأ المُبرمَج والغلط الإنشائي</h2>
<p>وسبب الخلط بينهما لغاتٌ جعلت آلية معالجة الخطأ المُبرمَج تُمسك الغلط الإنشائي، مع أن البرنامج لا يستطيع معالجته إلا أن يستُرَ عليه ليُفسِد ويتفاقم، ومن هذه الأغلاط:</p>
<ol>
<li>طلب معدومٍ (Null Dereference)</li>
<li>تحويل نوع خاطئ (Incorrect Casting)</li>
<li>أخذ بيانات خارِجَ نطاق حاويها منه (Out-of-bounds Access Violation)</li>
<li>تنفيذ قسمة عدد على صِفر (Divide by Zero)</li>
<li>الدخول في تكرار لا نهائي (Infinite Loop)</li>
<li>تجاوُز حسابي علوي أو سفلي (Arithmetic Overflow or Underflow)</li>
<li>تكديس متجاوِز (Stack Overflow)</li>
<li>تمرير بيانات من نوع خاطئ (Invalid Argument)</li>
<li>عدم تعيين جميع المدخلات (Missing Argument)</li>
</ol>
<p>فترى Java و Python وغيرها، تستعمل try-catch throw لهذه الأغلاط والأخطاء المُبرمَجة، وهذا غلطٌ إنشائي أصليّ في هذه اللغات، ولذلك فإن لغاتٍ حديثة أتت وتداركت هذا الغلط، مثل: Rust, Go على سبيل المثال لا الحصر.</p>
<h1 id="-4">معالجة الخطأ المُبرمَج</h1>
<p>فالإجراء له طريقان مع حدوث الخطأ فيه:</p>
<p>الأول: أن يُخرج الخطأ لمن يستدعيه، فيكون بذلك أسند معالجته إليه.</p>
<p>الثاني: أن يُعالِجه هو، ويخفي على المستدعي أنه حدث أصلاً.</p>
<p>وبحسب الخطأ نعالجه:</p>
<ul>
<li>نُعلم المستخدم بوجود الخطأ</li>
<li>نعاود العملية مرة أخرى بعد فترة زمنية معيَّنة (وقد تكون باستخدام بيانات مختلفة)</li>
<li>نستخدم بديلاً</li>
<li>نستشير المستخدم</li>
<li>نوقف البرنامج</li>
</ul>
<h2 id="-5">ضرورة عدم إهمال الخطأ المُبرمَج</h2>
<p>الخطأ معلومة أقلُّ ما تفيده عدم تمام الإجراء المطلوب، وبالتالي فإن إهمال هذه المعلومة يفضي لخطأ إنشائي في البرنامج. فالبرنامج الذي لا يعالج الأخطاء الناتجة من الإجراءات، كالذي يستدعيها ولا يكترث بنتاجها، فهو برنامج ناقصٌ أصلاً، خاطئٌ منطقيًّا، وإذا أفلح فإنه أمرٌ استثنائي ولا يعني ذلك أن البرنامج صحيح.</p>
<p>وإن كان لك الخيار، فلا تختر لغةً الأصل فيها الإهمال مثل: JavaScript, PHP, Python, وغيرها، بل اختر لغة تعينك.</p>
<h2 id="-6">استرجاع حال ما قبل الإجراء</h2>
<p>فإن كان الإجراء أتمَّ خُطُواتٍ أثَّرَت خارجه، فإن تأتي استرجاع الحال الأولى كان حسَناً وإلا فبرسالة خطأ تُنبئ عن ذلك، وإن كان الخروج بالخطأ لا يُفيد فعليك بإيقاف البرنامَج.</p>
<p>وتجد لذلك (finally) وهي ما يُنفَّذ في نهاية الأمر ولو أخطأ الإجراء إن كان دخل في (try)،  أو (defer) وتنفّذ ما أُعطيَت حين الخروج بترتيبٍ عكسي.</p>
<h2 id="-7">تسلسل الأخطاء</h2>
<p>فالأخطاء تكون متسلسلة، فمثلاً: "تعذر رفع الملف: تعذر الوصول للخادم: تعذر الاتصال بالشبكة"، هذا الخطأ سلسلة من ثلاثة أخطاء أصلُها "تعذر الاتصال بالشبكة"، فقد يعالج إجراءٌ هذا الخطأ بأن يُعاوِد رفع الملف بعد حين.</p>
<ul>
<li>سَلسَلة الأخطاء في نود: <a href="https://github.com/joyent/node-verror">node-verror</a></li>
<li>سَلسَلة الأخطاء في جو: <a href="https://blog.golang.org/go1.13-errors">go1.13-errors</a></li>
</ul>
<h2 id="-8">إيصال رسالة الخطأ</h2>
<p>وأبسط صور ذلك أن يكتب رسالة الخطأ كما هي للمستخدم ليراها وحسب.</p>
<p>وقد يُخيِّر البرنامج المستخدم؛ فيختار فيمشي البرنامج بناءً على اختياره.</p>
<p>لكن الخطأ قد لا يعني المستخدم، وإنما يعني المطوّر أو مدير النظام الذي يشتغل عليه البرنامج، فحينها يُكتب الخطأ بصيغة معيَّنة ويُحفظ في سجلّ (log)، وقد يستأذن البرنامجُ المستخدم في إرسال رسالة الخطأ للمعني به. ولا بد في هذه الرسالة أن تكون دالَّة قدر الإمكان على سبب الخطأ ومكانه وحال البرنامج حينه، لأن ذلك يُسهِّلُ معالجته.</p>
<h1 id="-9">إصلاح الغلط الإنشائي</h1>
<p>وإني أحرِّص عليك أن لا تسوِّف معالجة ما تراه من علامات على وجود الأغلاط الإنشائية، لأنَّ ذلك يُنسى مع طول زمن المشروع، كما أنه بتراكمه يصعب معالجته لا كما لو أُصلح في حينه، وإن تُرك فإنه يكون سبباً لأغلاط أخرى، وهي مثله.</p>
<p>وإن كنت لا بُدَّ مؤجِّلاً؛ فسجّل الغلط وتاريخه وحال المشروع حينه حتى لا تنساه وحتى لا يخفى على من يأتي بعدك ممن لم يشهده معك.</p>
<h2 id="-10">المرحلة الأولى: العلم بوجود الغلط</h2>
<p>وعدوُّ ذلك أن يُمسكه فيكتمه ويُكمل، لأنه بذلك يُكنُّ فساداً يستشري إلى بقية أجزائه وقد يخرج إلى الأنظمة الأخرى المتصلة به، ثم قد لا يظهر إلا بعد إحداث أغلاطٍ إنشائية وأخطاءٍ مُبرمَجة أخرى، فيصعب حينئذٍ تتبع أصل الغلط لإصلاحه.</p>
<p>وهذا يعود بالدرجة الأولى للغة البرمجة (مفرداتها وأدواتها التي تحلل تركيباتها)، فمن الأغلاط الإنشائية ما يُمكن ضبطه بالتحليل الآلي للبرنامج المكتوب، ومنها ما يستحيل ضبطه لأنه صحيح التركيب لكن على وجهٍ لا يحقق المراد.</p>
<h2 id="-11">المرحلة الثانية: تتبع أصل الغلط</h2>
<p>تفرز اللغة رسالة آليَّة تحتوي سلسلة الاستدعاءات التي كانت حين حدوث الغلط، واسم الملف ورقم السطر الذي حصل فيه.</p>
<p>ويُمكن استعمال المدقق (debugger) الذي يوقف البرنامج عند نقاط توقُّف محدده، ويُطْلعه على حال البرنامج عند تلك النقطة، كما يُمكّنه من التحكم في التنفيذ بالخطوِ خطوة واحدة أو الإكمال العادي حتى نقطة توقُّف قادمة.</p>
<p>أما استعمال الكتابة على السجلات الظاهرة باستعمال console.log أو printf ومثيلاتها بغرض التدقيق، فإن ذلك غالبًا ما يكون أفضل منه استعمال المدقق، ولذلك يَحسُن بالمبرمج تعلم استخدام مدقق لغته.</p>
<h2 id="-12">المرحلة الثالثة: إصلاح الغلط</h2>
<p>ولا نبدأ بالإصلاح إلا بعد تعيين أصل الغلط، ثم يكون موضِعُ الإصلاح ذلك الموضع لا غيره،  وقد يكون بإزالة أو إضافة أو تعديل أو تغيير ترتيب، ونحرص فيه أن نُصلِحَ ما يترتب على هذا الإصلاح من الأغلاط في مواضع أخرى.</p>
<p>وليس من الأمانة ترقيع الأغلاط، ولا إسكات الأخطاء، أو تعمُّد مخالفة وصف الإجراء لتفاصيله، أو افتعال الأغلاط أو تعمُّد الإنشاء الهشّ، فإنَّ فعل ذلك في البرمجيات مثل فعله في الإنشاءات (المباني).</p>
        </div>
    </div>
    <footer class="center">
    <p id="copyright">
        الحقوق محفوظة - حسان القوز 2020 ©
    </p>
</footer>
</body>
</html>