title=معالجة الخطأ المُبرمَج وإصلاح الغلط الإنشائي
date=2020-11-24
dir=rtl
lang=ar
----------------------

المحاور
- معيار صحة البرنامج
- الفرق بين الغلط الإنشائي والخطأ المُبرمَج
- معالجة الخطأ المَبرمَج
- إصلاح الغلط الإنشائي

# معيار صحة البرنامج
البرنامج إجراءات. فإذا كان كل إجراء صحيح، خلا البرنامج من الأغلاط.

وصحة الإجراء أن تُصِّدق تفاصيلُه وصفَه.

والإجراء له وصفان: وصفٌ بلغة البرمجة، ووصفٌ بلغة الخطاب. فالأوَّل تفهمه الأدوات البرمجية فتساعدك في الكتابة والتعديل والقراءة، والثاني يفهمه المستخدم ويُسمَّى التوثيق (documentation).

فالوصف بلغة البرمجة يحوي مُعرِّف الإجراء، وقيوداً أخرى.

فمُعرِّف الإجراء (function signature): هو ما يُميَّز به بين إجراءٍ وآخر، فمن ذلك: اسم الإجراء ومدخلاته ونوعها ومخرجاته ونوعها. فإذا اتفق اسمان، عرف البرنامج أي الإجرائين يُجري باختلاف الحدود الأخرى للمعرِّف. وهذا يُعرف باسم (function overloading).

وقد تقيِّد اللغة المدخلات والمخرجات بما يزيد عن تحديد نوعها، وهو ما يُعرفُ بالتوكيد (Assertion).

فإذا قرأ المستخدم الوصفين عرف ما يأخذ الإجراء وما يُخرج، فلا يعطيه ما لا يقبل ولا يتوقَّع منه ما لا يضمن.

وبالتوثيق يُعرف مدى تأثر وتأثير الإجراء؛ فقد يتأثر بغير مُدخلاته، أو يؤثِّرُ هو بمدخلاته، أو يؤثّر في غير محلّ مخرجاته، ومثل ذلك يصعُب ضبطه فاجتنابه أسلم وأقرب للصحة.

# الفرق بين الغلط الإنشائي والخطأ المُبرمَج
والخطأ المُبرمَج أحد المخرجات ويدلُّ على سلوك مسارٍ غير المعتاد.

أما الغلط الإنشائي (Bug) فإنه تحوُّلٌ يقع فيُخرج البرنامج إلى حالة غير مُبرمَجة (ليست في منطق البرنامج)، ولذلك فإنه لا حوْل للبرنامج في معالجته.

فالغلط الإنشائي يؤثِّرُ على صِحَّة البرنامج وقد يضرُّ بالموارد: كأن يستنزف الذاكرة أو يملأ المخزن، أو يسمح لمن ليس له السماح، فاللغة المفلحة تُعلِم المبرمج فوْر وقوعه وتوقف البرنامج.

وسبب الخلط بينهما لغاتٌ جعلت آلية معالجة الخطأ المُبرمَج تُمسك الغلط الإنشائي، مع أن البرنامج لا يستطيع معالجته إلا أن يستُرَ عليه ليُفسِد ويتفاقم. فمن هذه الأغلاط:
1. طلب معدومٍ (Null Dereference)
2.	تحويل نوع خاطئ (Incorrect Casting)
3.	أخذ بيانات خارِجَ نطاق حاويها منه (Out-of-bounds Access Violation)
4.	تنفيذ قسمة عدد على صِفر (Divide by Zero)
5.	الدخول في تكرار لا نهائي (Infinite Loop)
6.	تجاوُز حسابي علوي أو سفلي (Arithmetic Overflow or Underflow)
7.	تكديس متجاوِز (Stack Overflow)
8.	تمرير بيانات من نوع خاطئ (Invalid Argument)
9.	عدم تعيين جميع المدخلات (Missing Argument)

فترى Java و Python وغيرها، تستعمل try-catch throw لهذه الأغلاط والأخطاء المُبرمَجة.

# معالجة الخطأ المُبرمَج (Error)
فإذا رجع لإجراءٍ خطأٌ من إجراء، ينظر فيه ليقرر هل يرجع هو بخطأ أو يسلك إجراءً آخر.

فالأخطاء تكون متسلسلة، فمثلاً: "تعذر رفع الملف: تعذر الوصول للخادم: تعذر الاتصال بالشبكة"، هذا الخطأ سلسلة من ثلاثة أخطاء أصلُها "تعذر الاتصال بالشبكة"، فقد يعالج إجراءٌ هذا الخطأ بأن يُعاوِد رفع الملف بعد حين.

ولاحظ أن "تعذر الاتصال بالشبكة" أمرٌ خارجٌ عن طاقة البرنامج، إلا أنه أمرٌ وارد، ولذلك نُبرمج له مسارًا.

وقد يكون الخطأ: "تعذر رفع الصورة، تجاوز الحجم الحد الأعلى (2 ميجا)"، فيكون علاج مثل هذا النوع من الأخطاء إيصال نصه لمن يملك معالجته؛ كالمستخدم.

وقد يحتاج إلى إيصاله للمطوِّر أو مدير النظام.

والإجراء الذي قطع شوطاً ثُمَّ واجه خطأً، يجب فيه استعادة الحال الأولى ثم يخرج بالخطأ (إن كان سيخرج به)، وإلا كان ذلك غلطاً إنشائيًّا.

وقد يكون علاج الخطأ بإنهاء البرنامج فوْراً.

# إصلاح الغلط الإنشائي (Bug)
## المرحلة الأولى: العلم بوجود الغلط
وعدوُّ ذلك أن يُمسكه فيكتمه ويُكمل، لأنه بذلك يُكنُّ فساداً يستشري إلى بقية أجزائه وقد يخرج إلى الأنظمة الأخرى المتصلة به، ثم قد لا يظهر إلا بعد إحداث أغلاطٍ إنشائية وأخطاءٍ مُبرمَجة أخرى، فيصعب حينئذٍ تتبع أصل الغلط لإصلاحه.

فأفضل حلّ للخطأ الإنشائي: أن ينتهي البرنامج عنده.

## المرحلة الثانية: تتبع أصل الغلط
 تفرز اللغة رسالة آليَّة تحتوي سلسلة الاستدعاءات التي كانت حين حدوث الغلط، واسم الملف ورقم السطر الذي حصل فيه.

ويُمكن استعمال المدقق (debugger) الذي يوقف البرنامج عند نقاط توقُّف محدده، ويُطْلعه على حال البرنامج عند تلك النقطة، كما يُمكّنه من التحكم في التنفيذ بالخطوِ خطوة واحدة أو الإكمال العادي حتى نقطة توقُّف قادمة.

أما استعمال الكتابة على السجلات الظاهرة باستعمال console.log أو printf ومثيلاتها بغرض التدقيق، فإن ذلك غالبًا ما يكون أفضل منه استعمال المدقق، ولذلك يَحسُن بالمبرمج تعلم استخدام مدقق لغته.

## المرحلة الثالثة: إصلاح الغلط
ولا نبدأ بالإصلاح إلا بعد تعيين أصل الغلط، ثم يكون موضِعُ الإصلاح ذلك الموضع لا غيره،  وقد يكون بإزالة أو إضافة أو تعديل أو تغيير ترتيب، ونحرص فيه أن نُصلِحَ ما يترتب على هذا الإصلاح من الأغلاط في مواضع أخرى.